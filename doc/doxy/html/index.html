<!-- HTML header for doxygen 1.9.1-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>A9/A9G Libraries using Ai-Thinker GPRS C SDK  0.1.0: Ai-Thinker GPRS modules- A9/A9G Libraries using [Ai-Thinker GPRS C SDK]</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="2" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">A9/A9G Libraries using Ai-Thinker GPRS C SDK  0.1.0
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Ai-Thinker GPRS modules- A9/A9G Libraries using [Ai-Thinker GPRS C SDK] </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_README"></a> </p>
<h1><a class="anchor" id="autotoc_md22"></a>
Overview</h1>
<p>This SDK provides a wrapper over the most used functionalities for the Ai-Thinker GPRS SoC modules A9/A9G making for simpler setup and faster deployability.</p>
<p>The A9/A9G can be used in a wide variety of IoT applications. This low-cost, effective module can be the go-to product for quick development and deployment of IoT solutions around the world. Okay okay, I'm going to stop bragging about stuff you already know and get to the point of all this conversation.</p>
<p><b>What are we doing here?</b> This is an effort to share the knowledge and experience we gained in our process of using this module with the open-source community hoping it saves time and effort for as many IoTers out there as possible.</p>
<p><b>This brings me to talk about the drawbacks about trying to use the A9/A9G modules:</b></p><ul>
<li>Scattered Documentation plus language barriers.</li>
<li>AT commands do not provide anywhere near half the complete control that can be obtained on this module using the SDK.</li>
<li>Development on this product has been almost completely stopped.</li>
</ul>
<p><b>What does this SDK do to solve these?</b></p><ul>
<li>This library provides an easier-to-use and ready-to-deploy, out of the box API wrapper over the GPRS_C_SDK provided by Ai-Thinker. Dont get me wrong, you will still need to use and setup the GPRS_C_SDK and setup the toolkit, but we have tried to simplify it for you so you dont need to waste your precious time looking for the right links and putting the documents together(which if you keep scrolling, you'll find all the steps to get you going!).</li>
<li>On top of that, we provide wrapper functions/APIs to maintain homogeneity as much as possible in your code structuring and writing.</li>
<li>They also help you skip complex steps in order to get the job done with simpler, lesser code and better documentation!</li>
</ul>
<p>Please do keep reading to know more. And since we rely on your inputs and feedback to grow and improve this project and hence the open-source community in general, please feel free to <a href="## Feedback">give us feedback</a><a href="## Participate in the development">create issues, suggest edits and add functionalities</a>. Dont forget to <code> Star </code> us on the top right corner of this project if you like what we are trying to achieve!</p>
<p>With increasing traffic, we will come up with rigid procedures to maintain process in the same. Until then, HAVE FUN AND KEEP IoTing!</p>
<h1><a class="anchor" id="autotoc_md23"></a>
Features</h1>
<ul>
<li>Provides an easier-to-use and ready-to-deploy out of the box API. Integrates a wide range of features including:<ul>
<li>[x] GPIO</li>
<li>[x] Power Management</li>
<li>[x] MQTT</li>
<li>[x] SPI</li>
<li>[x] I2C</li>
<li>[x] Integration with ADS1015 over I2C</li>
<li>[ ] ADC</li>
<li>[ ] GPS</li>
<li>[ ] OTA</li>
<li>[ ] Call</li>
<li>[ ] SMS</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md24"></a>
Hardware</h1>
<h2><a class="anchor" id="autotoc_md25"></a>
1. A9: GPRS Module</h2>
<p>(<a href="http://www.ai-thinker.com/pro_view-9.html">http://www.ai-thinker.com/pro_view-9.html</a>)</p>
<p><img src="./doc/assets/A9.png" alt="" class="inline"/> <br  />
</p>
<p><b>Datasheet of the A9 module <a href="./doc/Datasheets/Ai-Thinker-A9-GPRS-Series-Module-Datasheet.pdf">here</a></b></p>
<p><b>Features</b>:</p><ul>
<li>RDA 32 bit RISC core, frequency up to 312MHz, with 4k instruction cache, 4k data cache</li>
<li>Up to 29 GPIOs (with two download pins)</li>
<li>Calendar (Real Time Clock) with alarm</li>
<li>1 USB1.1 device interface</li>
<li>2 UART interface with flow control (+1 download/debug serial port)</li>
<li>2 SPI interface</li>
<li>3 I<sup>2</sup>C interface</li>
<li>1 SDMMC controller (interface)</li>
<li>2 ADC interface, 10 bits</li>
<li>32Mb (4MB) SPI NOR Flash</li>
<li>32Mb (4MB) DDR PSRAM</li>
<li>8kHz, 13Bits/sample ADC mic</li>
<li>48kHz, 16bits/sample DAC Audio</li>
<li>Power Management Unit: Lithium battery charge management, integrated DC-DC and LDOs, variable IO voltage</li>
<li>18.8 x 19.2 mm SMD package</li>
<li>Quad-band GSM/GPRS (800/900/1800 / 1900MHz)</li>
<li>Calls</li>
<li>SMS service</li>
</ul>
<h2><a class="anchor" id="autotoc_md26"></a>
2. A9G: GPRS + GPS + BDS Module</h2>
<p>(<a href="http://www.ai-thinker.com/pro_view-28.html">http://www.ai-thinker.com/pro_view-28.html</a>)</p>
<p><img src="./doc/assets/A9G.png" alt="" class="inline"/> <br  />
</p>
<p><b>Datasheet of the A9G module <a href="./doc/Datasheets/Ai-Thinker-A9G-GPRS-Series-Module-Datasheet.pdf">here</a></b></p>
<p><b>Features</b>:</p><ul>
<li>All the features of A9 above</li>
<li>Integrated GPS+BDS (connected to UART2 internal of module)</li>
</ul>
<h2><a class="anchor" id="autotoc_md27"></a>
3. A9</h2>
<p>(<a href="http://www.ai-thinker.com/pro_view-78.html">http://www.ai-thinker.com/pro_view-78.html</a>)/</p>
<p>A9G GPRS (+GPS+BDS) Development Board( pudding)</p>
<p>(<a href="http://www.ai-thinker.com/pro_view-77.html">http://www.ai-thinker.com/pro_view-77.html</a>)</p>
<p><img src="./doc/assets/A9G_dev.png" alt="" class="inline"/> <br  />
 A9/A9G development board for easy development and debugging</p>
<p><b>Schematics of the pudding development boards here: <a href="./doc/Schematics/a9-dev-schematic_v1.2.pdf">A9</a> | <a href="./doc/Schematics/a9g-dev-schematic_v1.2.pdf">A9G</a></b></p>
<p><b>Features</b>:</p><ul>
<li>1 A9G module (the board is the same for the A9 and A9G, they use identical packages with the same pinouts.)</li>
<li>29 GPIOs with 2.45mm spacing (with 2 download debug pins (<code>HST_TX</code>,<code>HST_RX</code>)</li>
<li>One SIM card slot (Nano Card &lt;Micro Card &lt;Standard Card)</li>
<li>1 TF card slot</li>
<li>1 GPRS interface with IPEX 1 generation package</li>
<li>1 GPS interface with IPEX 1 generation package</li>
<li>1 micro USB interface</li>
<li>5v-4.2V DC-DC, it can be 5v power supply or 3.8 ~ 4.2V power supply</li>
<li>~~1 accelerometer chip(LIS3DHx)~~(not soldered by default)</li>
<li>1 power key, and a reset button</li>
<li>2 LED</li>
<li>1 microphone <br  />
 <img src="./doc/assets/pudding_pin.png" alt="" class="inline"/> <br  />
</li>
</ul>
<blockquote class="doxtable">
<p>Or you can use other RDA8955 chip modules or board </p>
</blockquote>
<h2><a class="anchor" id="autotoc_md28"></a>
4. USB to Serial Module</h2>
<p><img src="./doc/assets/USB-UART.png" alt="" class="inline"/> <br  />
 It should be noted that the USB interface on the development board does not implement a USB serial port, but is a standard USB1.1 interface, Therefore, in order to download or debug, you need at least one USB to serial port translator module to connect to the board's <code>HST_TX</code> and<code>HST_RX</code> pins</p>
<h2><a class="anchor" id="autotoc_md29"></a>
5. Power Supply</h2>
<p>Power can be supplied by a lithium battery or a fixed external supply (3.8v ~ 4.2v) to the <code>VBAT</code> pin. Alternatively, it can also be powered by 5v power connected to the 5v input pin or USB input. However, it should be noted that if using alithium battery as power supply POWER KEY needs to be pressed for about 3 seconds to power on the module. This is not required when powered through USB.</p>
<h1><a class="anchor" id="autotoc_md30"></a>
Hardware connection</h1>
<h2><a class="anchor" id="autotoc_md31"></a>
Module Debugging and Firmware Download</h2>
<p>The download interface to the device is the HST interface. Depending upon how the power is being supplied to the board(pudding), the following connections are required at the minimum to provision firmware download into the device or to debug the logs.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">USB to TTL module   </th><th class="markdownTableHeadNone">Dev Board(pudding)    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">TX   </td><td class="markdownTableBodyNone">HST_RX    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">RX   </td><td class="markdownTableBodyNone">HST_TX    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">GND   </td><td class="markdownTableBodyNone">GND   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md32"></a>
Power Supply</h2>
<h1><a class="anchor" id="autotoc_md33"></a>
Setting up the build environment</h1>
<h2><a class="anchor" id="autotoc_md34"></a>
Windows</h2>
<h3><a class="anchor" id="autotoc_md35"></a>
Download the SDK:</h3>
<ul>
<li>Download the latest released archive from <a href="https://github.com/Ai-Thinker-Open/GPRS_C_SDK/releases">github release page</a> or clone directly (need to have installed <code>git</code>). <div class="fragment"><div class="line">git clone https://github.com/Ai-Thinker-Open/GPRS_C_SDK.git --recursive</div>
</div><!-- fragment --> <blockquote class="doxtable">
<p>This repo has been tested on <a href="https://github.com/Ai-Thinker-Open/GPRS_C_SDK/tree/555064940173977fa51aac860c800a2d3f4e890a">this version</a> </p>
</blockquote>
* Decompress the CSDK downloaded to GPRS_C_SDK folder into a directory, such as ~/projects/GPRS_C_SDK.</li>
</ul>
<h3><a class="anchor" id="autotoc_md36"></a>
Download and install the toolchain:</h3>
<ul>
<li>Download the toolchain <a href="https://github.com/zkemble/GPRS_C_SDK/releases/download/v2.129/CSDTK42_Update2_18_7_27.7z">here</a>.</li>
<li>Decompress the downloaded file into a folder.</li>
<li>Run <code>config_env_admin.bat</code> file in CSDTK to set environment variables required.</li>
</ul>
<h3><a class="anchor" id="autotoc_md37"></a>
Compile a demo app:</h3>
<ul>
<li>Navigate into the CSDK folder，right click your mouse in the blank space in the folder with shift key pressed, then <code>Open PowerShell window here</code>.</li>
<li><p class="startli">Then you can use the <code>./build.bat</code> script to build the project.</p><ul>
<li><code>./build.bat demo $PROJ</code>: compile demo project $PROJ e.g.: <code>./build.bat demo gpio</code></li>
<li><code>./build.bat clean $PROJ</code>: clear the build files of $PROJ e.g.: <code>./build.bat clean gpio</code></li>
<li><code>./build.bat clean all</code>: clear all build files</li>
<li><code>./build.bat demo $PROJ release</code>: build a release version. e.g.: <code>./build.bat demo gpio release</code></li>
</ul>
<p class="startli">If the last parameter is not <code>release</code>, the build default is to generate the debug version. The GDB can be used to debug errors after system crashes in the debug version The release version can not be used with GDB, crashes will result in the watch dog timer activating and it will auto restart the system when the system crashes!</p>
</li>
<li>A <code>build</code> folder and a <code>hex</code> folder will be generated after compilation containing the build files.</li>
<li>In the <code>hex</code> folder, two *.lod files will be generated. These *.lod files are the target file that are to be flashed into the dev board.</li>
<li>The two *.lod files will be significantly different in their sizes. The larger file should be flashed when:<ul>
<li>Flashing for the first time</li>
<li>If SDK level changes have been made <br  />
 Else, the smaller file can be flashed in order to reduce the download time significantly.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md38"></a>
Linux</h2>
<h3><a class="anchor" id="autotoc_md39"></a>
Download the SDK:</h3>
<ul>
<li>Create a project folder <code>projects</code> <div class="fragment"><div class="line">mkdir ~/projects</div>
</div><!-- fragment --></li>
<li>Download the latest released archive from <a href="https://github.com/Ai-Thinker-Open/GPRS_C_SDK/releases">github release page</a> or clone directly(need to install <code>git</code>) <div class="fragment"><div class="line">git clone https://github.com/Ai-Thinker-Open/GPRS_C_SDK.git --recursive</div>
</div><!-- fragment --> <blockquote class="doxtable">
<p>This repo has been tested on <a href="https://github.com/Ai-Thinker-Open/GPRS_C_SDK/tree/555064940173977fa51aac860c800a2d3f4e890a">this version</a> </p>
</blockquote>
* Decompress the CSDK downloaded to GPRS_C_SDK folder into the directory, such as ~/projects/GPRS_C_SDK.</li>
</ul>
<h3><a class="anchor" id="autotoc_md40"></a>
Download and install the toolchain:</h3>
<ul>
<li>Install dependencies for compile tool <div class="fragment"><div class="line">sudo apt install build-essential gcc-multilib g++-multilib libzip-dev zlib1g lib32z1 libpng12-0 libusb-0.1-4</div>
</div><!-- fragment --></li>
<li>Since the official download links in the official Ai-Thinker website is dead, download the toolchain <a href="https://github.com/pulkin/csdtk42-linux">here</a></li>
<li>Decompress the downloaded file to a folder, ~/software/CSDTK for example, and then execute setup.sh, the first parameter is the location of CSDTK, the second parameter is the location of your projects. <div class="fragment"><div class="line">cd ~/software</div>
<div class="line">tar -xzvf CSDTK42_Linux.tar.gz</div>
<div class="line">cd CSDTK</div>
<div class="line">./setup.sh ./ ~/projects</div>
</div><!-- fragment --></li>
</ul>
<h3><a class="anchor" id="autotoc_md41"></a>
Compile a demo app:</h3>
<ul>
<li>Navigate into the CSDK folder，right click mouse in the blank space in the folder with shift key pressed, then <code>Open PowerShell window here</code>.</li>
<li><p class="startli">Then you can use <code>./build.sh</code> script to build project.</p><ul>
<li><code>./build.sh demo $PROJ</code>: compile demo project $PROJ e.g.: <code>./build.sh demo gpio</code></li>
<li><code>./build.sh clean $PROJ</code>: clear the build files of $PROJ e.g.: <code>./build.sh clean gpio</code></li>
<li><code>./build.sh clean all</code>: clear all build files</li>
<li><code>./build.sh demo $PROJ release</code>: e.g.: <code>./build.sh demo gpio release</code></li>
</ul>
<p class="startli">If the last parameter is not <code>release</code>, the build default is to generate the debug version. The GDB can be used to debug errors after system crashes in the debug version The release version can not be used with GDB, crashes will result in the watch dog timer activating and it will auto restart the system when the system crashes! e.g.: <code>./build.sh demo gpio release</code></p>
</li>
<li>A <code>build</code> folder and a <code>hex</code> folder will be generated after compilation containing the build files.</li>
<li>In the <code>hex</code> folder, two *.lod files will be generated. These *.lod files are the target file that are to be flashed into the dev board.</li>
<li>The two *.lod files will be significantly different in their sizes. The larger file should be flashed when:<ul>
<li>Flashing for the first time</li>
<li>If SDK level changes have been made <br  />
 Else, the smaller file can be flashed in order to reduce the download time significantly.</li>
</ul>
</li>
</ul>
<h2><a class="anchor" id="autotoc_md42"></a>
Flash and Debug:</h2>
<p><b>Additional Steps for Linux:</b> (not required for Windows)</p><ul>
<li>Install dependencies <div class="fragment"><div class="line">sudo apt install build-essential libqt4-qt3support itcl3 itk3 iwidgets4</div>
</div><!-- fragment --></li>
<li>Create a link file for serial port as follows, and later you can fill in the coolwatcher's chart with 1. The <code>COM1</code> must upper-case. <div class="fragment"><div class="line">sudo ln -s /dev/ttyUSB0 comport/COM1</div>
</div><!-- fragment --></li>
<li>Then double click coolwatcher to run software</li>
<li>Follow further steps as given in <a href="https://ai-thinker-open.github.io/GPRS_C_SDK_DOC/en/c-sdk/burn-debug.html">Ai-Thinker GPRS SDK documentation</a>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md43"></a>
Project structure and developing applications</h2>
<p>Each folder contains the C library and corresponding header files. To use the library files follow the steps below:</p>
<ul>
<li>Copy the lib folder of the project to be run into the <a href="https://github.com/Ai-Thinker-Open/GPRS_C_SDK/tree/master/demo">demo</a> folder of your installed SDK.</li>
<li>Navigate into the folder and read the README.md file of the specific example to configure the example code if needed. For example, to test the MQTT library example, the endpoint, certificates and keys have to be provided to establish a successful connection.</li>
<li>Build and flash the code as mentioned above.</li>
</ul>
<p><b>Further Detailed Doumentation</b> here: <a href="https://ai-thinker-open.github.io/GPRS_C_SDK_DOC/en">GPRS C SDK DOC</a></p>
<p>Including environment installation, burn &amp; debug, api docs etc.</p>
<h2><a class="anchor" id="autotoc_md44"></a>
Generating the Documentation</h2>
<p>This SDK comes with a convenient, browsable set of documentation. The documentation is available in HTML format in the <code>doc/doxy/html</code> directory of the repository.</p>
<p>You can update this documentation by running the command <code>doxygen Doxyfile</code> in the base directory of the repository. You will need to have previously installed the <a href="https://www.doxygen.nl/">Doxygen</a> package. </p>
<h2><a class="anchor" id="autotoc_md45"></a>
Feedback</h2>
<ul>
<li><a href="https://github.com/IoTReady/a9_libraries/issues/new">create issue on github</a></li>
<li>Click ★ <code> Star </code> on the top right corner of this page if this repo helps you</li>
</ul>
<h2><a class="anchor" id="autotoc_md46"></a>
Participate in the development</h2>
<p>Fork -&gt; Modify -&gt; Submit PR </p>
</div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.9.1-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://iotready.co"> IoTReady </a><img class="footer" src="logo.png" width="30" height="30" alt="IoTReady"/></a></li>
  </ul>
</div>
</body>
</html>
